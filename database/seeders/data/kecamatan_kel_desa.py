import os
import re
import pandas as pd

raw = """
3506010 KECAMATAN MOJO
 001 NGETREP
 002 NGADI
 003 KRANDING
 004 MAESAN
 005 PONGGOK
 006 PETUNGROTO
 007 PAMONGAN
 008 KEDAWUNG
 009 PLOSO
 010 TAMBIBENDO
 011 KRATON
 012 BLIMBING
 013 JUGO
 014 MOJO
 015 MLATI
 016 SURAT
 017 SUKOANYAR
 018 KENITEN
 019 MONDO
 020 PETOK
3506020 KECAMATAN SEMEN
 001 SELOPANGGUNG
 002 PUHRUBUH
 003 SIDOMULYO
 004 BULU
 005 BOBANG
 006 PUHSARANG
 007 KANYORAN
 008 JOHO
 009 PAGUNG
 010 KEDAK
 011 TITIK
 012 SEMEN
3506030 KECAMATAN NGADILUWIH
 001 TALES
 002 SLUMBUNG
 003 BRANGGAHAN
 004 SEKETI
 005 BANGGLE
 006 NGADILUWIH
 007 PURWOKERTO
 008 DUKUH
 009 REMBANGKEPUH
 010 BEDUG
 011 REMBANG
 012 BADAL
 013 BADAL PANDEAN
 014 WONOREJO
 015 BANJAREJO
 016 MANGUNREJO
3506040 KECAMATAN KRAS
 001 SETONOREJO
 002 PELAS
 003 BLEBER
 004 REJOMULYO
 005 MOJOSARI
 006 BUTUH
 007 JABANG
 008 KARANGTALUN
 009 NYAWANGAN
 010 KRAS
 011 BENDOSARI
 012 KRANDANG
 013 KANIGORO
 014 BANJARANYAR
 015 PURWODADI
 016 JAMBEAN
3506050 KECAMATAN RINGINREJO
 001 JEMEKAN
 002 SRIKATON
 003 SAMBI
 004 RINGINREJO
 005 DEYENG
 006 BATUAJI
 007 DAWUNG
 008 PURWODADI
 009 SELODONO
 010 SUSUHBANGO
 011 NAMBAKAN
3506060 KECAMATAN KANDAT
 001 SUMBERJO
 002 KARANGREJO
 003 SELOSARI
 004 KANDAT
 005 CENDONO
 006 RINGINSARI
 007 TEGALAN
 008 NGLETIH
 009 PURWOREJO
 010 PULE
 011 BLABAK
 012 NGRECO
3506070 KECAMATAN WATES
 001 DUWET
 002 TAWANG
 003 SEGARAN
 004 GADUNGAN
 005 POJOK
 006 WONOREJO
 007 WATES
 008 JAJAR
 009 TUNGE
 010 TEMPUREJO
 011 PLAOSAN
 012 KARANGANYAR
 013 SUMBERAGUNG
 014 PAGU
 015 JOHO
 016 SILIR
 017 JANTI
 018 SIDOMULYO
3506080 KECAMATAN NGANCAR
 001 BEDALI
 002 MARGOURIP
 003 MANGGIS
 004 SEMPU
 005 SUGIHWARAS
 006 NGANCAR
 007 PANDANTOYO
 008 KUNJANG
 009 JAGUL
 010 BABADAN
3506090 KECAMATAN PLOSOKLATEN
 001 GONDANG
 002 KAYUNAN
 003 PANJER
 004 JARAK
 005 SEPAWON
 006 PLOSOKIDUL
 007 BRENGGOLO
 008 PLOSOLOR
 009 WONOREJO TRISULO
 010 PRANGGANG
 011 PUNJUL
 012 KLANDERAN
 013 DONGANTI
 014 KAWEDUSAN
 015 SUMBERAGUNG
3506100 KECAMATAN GURAH
 001 NGLUMBANG
 002 BLIMBING
 003 NGASEM
 004 BANGKOK
 005 BESUK
 006 BOGEM
 007 TURUS
 008 BANYUANYAR
 009 GABRU
 010 WONOJOYO
 011 KRANGGAN
 012 GURAH
 013 SUMBERCANGKRING
 014 TIRU KIDUL
 015 TIRU LOR
 016 TAMBAKREJO
 017 GEMPOLAN
 018 KERKEP
 019 SUKOREJO
 020 GAYAM
 021 ADAN-ADAN
3506110 KECAMATAN PUNCU
 001 SATAK
 002 PUNCU
 003 ASMOROBANGUN
 004 WONOREJO
 005 MANGGIS
 006 SIDOMULYO
 007 WATUGEDE
 008 GADUNGAN
3506120 KECAMATAN KEPUNG
 001 KEBONREJO
 002 BESOWO
 003 KAMPUNGBARU
 004 SIMAN
 005 BRUMBUNG
 006 KEPUNG
 007 KRENCENG
 008 KENCONG
 009 KELING
 010 DAMARWULAN
3506130 KECAMATAN KANDANGAN
 001 KLAMPISAN
 002 KANDANGAN
 003 MLANCU
 004 MEDOWO
 005 BANARAN
 006 BUKUR
 007 KASREMAN
 008 KEMIRI
 009 KARANGTENGAH
 010 JERUKWANGI
 011 JERUKGULUNG
 012 JLUMBANG
3506140 KECAMATAN PARE
 001 SIDOREJO
 002 GEDANGSEWU
 003 SUMBERBENDO
 004 DARUNGAN
 005 SAMBIREJO
 006 BENDO
 007 PELEM
 008 TULUNGREJO
 009 PARE
 010 TERTEK
3506141 KECAMATAN BADAS
 001 SEKOTO
 002 BRINGIN
 003 LAMONG
 004 CANGGU
 005 KRECEK
 006 TUNGLUR
 007 BADAS
 008 BLARU
3506150 KECAMATAN KUNJANG
 001 KAPAS
 002 KAPI
 003 TENGGERLOR
 004 WONOREJO
 005 BALONGJERUK
 006 KUWIK
 007 DUNGUS
 008 JUWET
 009 KUNJANG
 010 KLEPEK
 011 PAKIS
 012 PARELOR
3506160 KECAMATAN PLEMAHAN
 001 KAYEN LOR
 002 BOGOKIDUL
 003 MEJONO
 004 TEGOWANGI
 005 LANGENHARJO
 006 PUHJARAK
 007 SEBET
 008 PAYAMAN
 009 WONOKERTO
 010 NGINO
 011 BANJAREJO
 012 SIDOWAREK
 013 RINGINPITU
 014 SUKOHARJO
 015 MOJOAYU
 016 PLEMAHAN
 017 MOJOKEREP
3506170 KECAMATAN PURWOASRI
 001 MRANGGEN
 002 PESING
 003 JANTOK
 004 KETAWANG
 005 WONOTENGAH
 006 PURWOASRI
 007 PANDANSARI
 008 BLAWE
 009 BELOR
 010 TUGU
 011 BULU
 012 PURWODADI
 013 MUNENG
 014 KLAMPITAN
 015 SIDOMULYO
 016 SUMBERJO
 017 KEMPLENG
 018 WOROMARTO
 019 MERJOYO
 020 MEKIKIS
 021 KARANGPAKIS
 022 DAYU
 023 DAWUHAN
3506180 KECAMATAN PAPAR
 001 PURWOTENGAH
 002 KWARON
 003 MINGGIRAN
 004 PEHKULON
 005 PEHWETAN
 006 DAWUHAN KIDUL
 007 JANTI
 008 PAPAR
 009 MADURETNO
 010 NGAMPEL
 011 KEDUNGMALANG
 012 SUKOMORO
 013 KEPUH
 014 JAMBANGAN
 015 SRIKATON
 016 TANON
 017 PUHJAJAR
3506190 KECAMATAN PAGU
 001 BULUPASAR
 002 WONOSARI
 003 KAMBINGAN
 004 TANJUNG
 005 SEMEN
 006 WATES
 007 MENANG
 008 TENGGER KIDUL
 009 SEMANDING
 010 SITIMERT0
 011 PAGU
 012 BENDO
 013 JAGUNG
3506191 KECAMATAN KAYEN KIDUL
 001 BAYE
 002 BANGSONGAN
 003 SENDEN
 004 SAMBIROBYONG
 005 MUKUH
 006 SUKOHARJO
 007 JAMBU
 008 SEKARAN
 009 PADANGAN
 010 KAYEN KIDUL
 011 NANGGUNGAN
 012 SEMAMBUNG
3506200 KECAMATAN GAMPENGREJO
 010 JONGBIRU
 011 PUTIH
 012 SAMBIREJO
 016 SAMBIRESIK
 017 GAMPENG
 018 NGEBRAK
 019 WANENGPATEN
 020 TURUS
 021 PLOSOREJO
 022 KEPUHREJO
 023 KALIBELO
3506201 KECAMATAN NGASEM
 001 TUGUREJO
 002 SUMBEREJO
 003 PARON
 004 SUKOREJO
 005 NGASEM
 006 KARANGREJO
 007 KWADUNGAN
 008 NAMBAAN
 009 TOYORESMI
 010 WONOCATUR
 011 GOGORANTE
 012 DOKO
3506210 KECAMATAN BANYAKAN
 001 PARANG
 002 TIRON
 003 MANYARAN
 004 JATIREJO
 005 BANYAKAN
 006 MARON
 007 JABON
 008 NGABLAK
 009 SENDANG
3506220 KECAMATAN GROGOL
 001 KALIPANG
 002 GROGOL
 003 WONOASRI
 004 SONOREJO
 005 BAKALAN
 006 DATENGAN
 007 GAMBYOK
 008 SUMBERJO
 009 CERME
3506230 KECAMATAN TAROKAN
 001 TAROKAN
 002 BULUSARI
 003 KALIRONG
 004 KALIBOTO
 005 KEDUNGSARI
 006 SUMBERDUREN
 007 KEREP
 008 BLIMBING
 009 CENGKOK
 010 JATI
"""

# 1. Parse kecamatan & kelurahan
kec_list = []
desa_list = []
current_kec = None

for line in raw.splitlines():
    line = line.strip()
    if not line:
        continue
    m_kec = re.match(r'^(\d{7})\s+KECAMATAN\s+(.+)$', line)
    if m_kec:
        current_kec = m_kec.group(1)
        kec_list.append({
            'id': current_kec,
            'kode_kecamatan': current_kec[-3:],
            'nama_kecamatan': m_kec.group(2).strip(),
            'kab_kota_id': '3506'
        })
        continue
    m_desa = re.match(r'^(\d{3})\s+(.+)$', line)
    if m_desa and current_kec:
        desa_list.append({
            'id': current_kec + m_desa.group(1),
            'kode_kel_desa': m_desa.group(1),
            'nama_kel_desa': m_desa.group(2).strip(),
            'kecamatan_id': current_kec
        })

# 2. Create DataFrames
df_kec = pd.DataFrame(kec_list)
df_desa = pd.DataFrame(desa_list)

# 3. Prepare output directory (relative to this script)
output_dir = os.path.join(os.path.dirname(__file__), 'csv')
os.makedirs(output_dir, exist_ok=True)

# 4. File paths
kecamatan_csv = os.path.join(output_dir, 'kecamatan.csv')
kel_desa_csv  = os.path.join(output_dir, 'kel_desa.csv')

# 5. Write CSVs
df_kec.to_csv(kecamatan_csv, index=False)
df_desa.to_csv(kel_desa_csv, index=False)

print(f"CSV files saved:")
print(f" - {kecamatan_csv}")
print(f" - {kel_desa_csv}")